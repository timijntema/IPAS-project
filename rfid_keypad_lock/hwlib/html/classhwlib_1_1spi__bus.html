<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>hwlib: hwlib::spi_bus Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">hwlib
   </div>
   <div id="projectbrief">C++ hardware library for V1IPAS-TI</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacehwlib.html">hwlib</a></li><li class="navelem"><a class="el" href="classhwlib_1_1spi__bus.html">spi_bus</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classhwlib_1_1spi__bus-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">hwlib::spi_bus Class Reference<span class="mlabels"><span class="mlabel">abstract</span></span></div>  </div>
</div><!--header-->
<div class="contents">

<p>spi bus interface  
 <a href="classhwlib_1_1spi__bus.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="hwlib-spi_8hpp_source.html">hwlib-spi.hpp</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for hwlib::spi_bus:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classhwlib_1_1spi__bus.png" usemap="#hwlib::spi_bus_map" alt=""/>
  <map id="hwlib::spi_bus_map" name="hwlib::spi_bus_map">
<area href="classhwlib_1_1spi__bus__bit__banged__sclk__mosi__miso.html" title="bit-banged SPI bus implementation " alt="hwlib::spi_bus_bit_banged_sclk_mosi_miso" shape="rect" coords="0,56,252,80"/>
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ae6e20e12c547c64b6456997d938b6943"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classhwlib_1_1spi__bus.html#ae6e20e12c547c64b6456997d938b6943">write_and_read</a> (<a class="el" href="classhwlib_1_1pin__out.html">pin_out</a> &amp;sel, int n, const <a class="el" href="hwlib-defines_8hpp.html#ab8ef12fab634c171394422d0ee8baf94">byte</a> data_out[], <a class="el" href="hwlib-defines_8hpp.html#ab8ef12fab634c171394422d0ee8baf94">byte</a> data_in[])=0</td></tr>
<tr class="memdesc:ae6e20e12c547c64b6456997d938b6943"><td class="mdescLeft">&#160;</td><td class="mdescRight">spi read-and-write transaction  <a href="#ae6e20e12c547c64b6456997d938b6943">More...</a><br /></td></tr>
<tr class="separator:ae6e20e12c547c64b6456997d938b6943"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>spi bus interface </p>
<p>This class abstracts the interface of a master to a SPI bus.</p>
<p>The SPI (Serial Peripheral Interface) protocol is based on shift registers. The master (in most cases the micro-controller) generates clock pulses (SCLK), and on each pulse one bit of data is transferred from the shift register inside the master to the shift register inside the slave, AND one bit is transferred in the other direction. After N clock pulses, all N data bits in the master and the slave are exchanged. The MOSI line transfers data from master to slave (Master Out Slave In), the MISO (Master In Slave Out) line transfers data from the slave to the master.</p>
<div class="image">
<img src="spi-master-slave.png" alt="spi-master-slave.png"/>
</div>
<p>The SS (Slave Select) line is used to signal the start and end of a SPOI transfer. In most cases, the select line is active low.</p>
<div class="image">
<img src="spi-select-1.png" alt="spi-select-1.png"/>
</div>
<p>A SPI bus can have multiple slaves. All slaves (and the master) share the MOSI, MISO and SLCK lines. Each slave has a separate SS line, that is used to activate a single slave for a transfer.</p>
<div class="image">
<img src="spi-select-2.png" alt="spi-select-2.png"/>
</div>
<p>The SPI bus is a de-facto standard: there is no official document that defines it, but various manufacturers agree on how it should work and (more or less!) implement it the same. But there are differences that might give problems:</p><ul>
<li>the polarity (active low or active high) of the SS line</li>
<li>the initial level of the clock</li>
<li>the polarity of the clock (the clock edge on which the master and slave transfer data)</li>
<li>the (maximum) clock frequency</li>
</ul>
<p>As always, consult the datasheet of the chip for the details.</p>
<p>references:</p><ul>
<li><a href="https://embeddedmicro.com/tutorials/mojo/serial-peripheral-interface-spi">SPI explanation</a> (Embedded Micro Forum)</li>
<li><a href="https://en.wikipedia.org/wiki/Serial_Peripheral_Interface_Bus">Serial Peripheral Bus</a> (wikipedia) </li>
</ul>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="ae6e20e12c547c64b6456997d938b6943"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void hwlib::spi_bus::write_and_read </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classhwlib_1_1pin__out.html">pin_out</a> &amp;&#160;</td>
          <td class="paramname"><em>sel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="hwlib-defines_8hpp.html#ab8ef12fab634c171394422d0ee8baf94">byte</a>&#160;</td>
          <td class="paramname"><em>data_out</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="hwlib-defines_8hpp.html#ab8ef12fab634c171394422d0ee8baf94">byte</a>&#160;</td>
          <td class="paramname"><em>data_in</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>spi read-and-write transaction </p>
<p>This function simultaneously writes n bytes from data_out[] to the slave activated by the sel pin, and reads n bytes into data_in[]. When data_out is a nullptr, all-0 bytes are written. When data_in is a nullptr, the data that is read is not stored. </p>

<p>Implemented in <a class="el" href="classhwlib_1_1spi__bus__bit__banged__sclk__mosi__miso.html#aa54c0f670505249860f59d8d62b982ca">hwlib::spi_bus_bit_banged_sclk_mosi_miso</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="hwlib-spi_8hpp_source.html">hwlib-spi.hpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Apr 29 2016 14:54:29 for hwlib by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
